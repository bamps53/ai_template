## 回答のスタイル

- 日本語で回答すること。
- 実装を行うときは、実装例をコードで示したりせず、すぐに実装に取り掛かること。

## パッケージ管理

- uv のみを使用し、pip は絶対に使用しないでください。
- インストール: `uv add package`
- ツールの実行: `uv run tool`
- アップグレード: `uv add --dev package --upgrade-package package`
- 禁止事項: `uv pip install`、`@latest` 構文

## コード品質

- 無駄なコメントを追加しない。（例：import 文の使用目的や、今行った実装の内容の説明など）
- すべてのコードに型ヒントを付与する。
- 公開 API には docstring が必須。
- 関数は焦点を絞り、小さくする。
- 既存のパターンに従うこと。

## テスト

- フレームワーク: `uv run --frozen pytest`
- 非同期テスト: asyncio ではなく anyio を使用すること。
- カバレッジ: エッジケースとエラーをテストすること。
- 新機能にはテストが必要。
- バグ修正にはリグレッションテストが必要。

## 実装方針

- 最初に実施計画を考えて todo.md として書き出し、チェックを付けていくこと。
- 実装は以下の順に行うこと

  1. issue を再現するテストを追加する（不具合修正・機能追加の場合）
  2. テストを実行し、失敗することを確認する
  3. 修正・機能追加を行う
  4. 関連するテストを実行し、成功することを確認する
  5. 全てのテストを実行し、成功することを確認する
  6. テストが通った後で、lint/format を実行し、エラーが発生した場合は修正する
  7. lint エラーをすべて修正した後で、ドキュメントを更新する(README.md, docs/\*.md)
  8. 最後に、今回行った変更の差分を全て確認し、不適切な変更がないか改めて確認する
     - 今回のタスクに関係のない変更を行っていないか
     - 無駄に複雑な変更を行っていないか（より良い実装方法がないか）
     - 冗長なコメントが残っていないか

  - 途中で方針を変えた場合、最初に行った不必要な変更が残っていないか

- lint/format のエラーが機能修正中に発生した場合もその場で修正せず、最後にまとめて修正すること。
- python の lint/format には以下のコマンドを使用すること。
  - フォーマット: `uv run --frozen ruff format .`
  - チェック: `uv run --frozen ruff check .`
  - 修正: `uv run --frozen ruff check . --fix`

## ベストプラクティス

- 変更は最小限に
- 既存のパターンに従う
- 徹底的にテストする
